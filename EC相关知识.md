# 执行上下文相关知识

思维导图：
![](https://user-gold-cdn.xitu.io/2019/10/25/16e02085a7bd281c?w=1053&h=428&f=png&s=64804)
## 什么是执行上下文呢？
答：执行上下文可以理解为 js 代码的运行环境。

那我们再了解一下 js 的运行环境有三种：

1. 全局运行环境。
2. 函数运行环境。
3. eval环境（不常使用）。

## 那执行上下文的生命周期你知道有几个阶段呢？
答：两个阶段，创建阶段和代码执行阶段。

### 创建阶段

- 创建变量对象
- 创建作用域链
- 确定this指向

#### 创建变量对象

创建变量对象要有三个过程：
1.创建 arguments 对象
检查当前上下文的参数，建立该对象的属性和属性值，并且把形参初始在 VO 中（在函数环境中哦，全局环境中没有哦）。

2.检查函数声明创建属性
顺着代码下来，将找到的函数提前声明，如果当前的上下文的变量对象 VO 中没有该函数名，就要建立一个，属性值指向函数所在的堆内存地址的引用，若存在，则覆盖。

3.检查变量声明创建属性
顺着代码下来，将找到的变量提前声明，如果当前的上下文的变量是对象VO中没有该变量名，则建立一个以该变量名的属性，值为 undefined ，如果存在则忽略该变量声明。

### 代码执行阶段
进入代码执行阶段之后，变量对象变为活动对象。

- 变量赋值
- 函数引用
- 其他代码执行


## 作用域链
作用域链是由当前运行环境和上一层运行环境的所有变量对象组成的。它保证了变量和函数的有序访问

那作用域是什么呢？
其实大部分的人认为理解作用域是运行环境，实际上理解为作用域是变量对象，还更为准确一点，因为当前代码的运行环境更好的理解是理解成当前代码的执行上下文。从真正意义上说，作用域本质只是一套规则，一套配合引擎查找变量的规则，在编译阶段创建。
